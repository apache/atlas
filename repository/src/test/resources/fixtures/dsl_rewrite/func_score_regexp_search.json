{
    "min_score": 0.01,
    "from": 0,
    "size": 20,
    "track_total_hits": true,
    "sort": [
        {
            "_score": {
                "order": "desc"
            }
        },
        {
            "certificateStatus": {
                "order": "desc"
            }
        },
        {
            "dataProductScoreValue": {
                "order": "desc"
            }
        },
        {
            "popularityScore": {
                "order": "desc"
            }
        },
        {
            "starredCount": {
                "order": "desc"
            }
        }
    ],
    "highlight": {
        "pre_tags": [
            "<span>"
        ],
        "post_tags": [
            "</span>"
        ],
        "fields": {
            "displayName": {},
            "displayName.keyword": {},
            "name": {},
            "name.keyword": {}
        }
    },
    "query": {
        "function_score": {
            "query": {
                "bool": {
                    "filter": {
                        "bool": {
                            "must": {
                                "term": {
                                    "__state": "ACTIVE"
                                }
                            },
                            "should": [
                                {
                                    "terms": {
                                        "__superTypeNames.keyword": [
                                            "AI",
                                            "SQL",
                                            "BI",
                                            "SaaS",
                                            "ObjectStore",
                                            "EventStore",
                                            "DataQuality",
                                            "Dbt",
                                            "API",
                                            "Airflow",
                                            "Spark",
                                            "MWAA",
                                            "GCP_Cloud_Composer",
                                            "Astronomer",
                                            "SchemaRegistry",
                                            "Matillion",
                                            "NoSQL",
                                            "MultiDimensionalDataset",
                                            "ERD",
                                            "DataModeling",
                                            "ADF",
                                            "model",
                                            "Fivetran",
                                            "App",
                                            "Custom",
                                            "SAP",
                                            "Alteryx"
                                        ]
                                    }
                                },
                                {
                                    "terms": {
                                        "__typeName.keyword": [
                                            "Query",
                                            "Collection",
                                            "AtlasGlossary",
                                            "AtlasGlossaryCategory",
                                            "AtlasGlossaryTerm",
                                            "Connection",
                                            "File",
                                            "Process",
                                            "Process",
                                            "DbtProcess"
                                        ]
                                    }
                                }
                            ],
                            "must_not": [
                                {
                                    "term": {
                                        "isPartial": "true"
                                    }
                                },
                                {
                                    "terms": {
                                        "__typeName.keyword": [
                                            "Procedure",
                                            "DbtColumnProcess",
                                            "BIProcess",
                                            "MatillionComponent",
                                            "ModelVersion",
                                            "DataQualityRule",
                                            "SnowflakeTag",
                                            "DbtTag",
                                            "BigqueryTag",
                                            "AIApplication",
                                            "AIModel"
                                        ]
                                    }
                                },
                                {
                                    "terms": {
                                        "__typeName.keyword": [
                                            "MCIncident",
                                            "AnomaloCheck"
                                        ]
                                    }
                                }
                            ],
                            "minimum_should_match": 1
                        }
                    },
                    "should": [
                        {
                            "multi_match": {
                                "query": "mand",
                                "operator": "OR",
                                "fuzziness": "AUTO",
                                "fuzzy_transpositions": false,
                                "prefix_length": 3,
                                "max_expansions": 20,
                                "fields": [
                                    "name^10",
                                    "displayName^10"
                                ]
                            }
                        },
                        {
                            "regexp": {
                                "name": {
                                    "value": "[a-zA-Z0-9 &-._\"#%()[|]*mand.*",
                                    "case_insensitive": true,
                                    "boost": 10
                                }
                            }
                        },
                        {
                            "regexp": {
                                "displayName": {
                                    "value": "[a-zA-Z0-9 &-._\"#%()[|]*mand.*",
                                    "case_insensitive": true,
                                    "boost": 10
                                }
                            }
                        },
                        {
                            "match": {
                                "name": {
                                    "query": "mand",
                                    "boost": 2,
                                    "analyzer": "search_synonyms"
                                }
                            }
                        },
                        {
                            "multi_match": {
                                "query": "mand",
                                "fields": [
                                    "name.keyword^20",
                                    "displayName.keyword^20"
                                ]
                            }
                        },
                        {
                            "multi_match": {
                                "query": "mand",
                                "operator": "OR",
                                "fields": [
                                    "description^3",
                                    "userDescription^3",
                                    "sql"
                                ]
                            }
                        },
                        {
                            "match": {
                                "__meaningsText": {
                                    "query": "mand",
                                    "boost": 5
                                }
                            }
                        },
                        {
                            "match_bool_prefix": {
                                "__meaningNames.text": {
                                    "query": "mand",
                                    "boost": 5
                                }
                            }
                        }
                    ],
                    "minimum_should_match": 1
                }
            },
            "functions": [
                {
                    "filter": {
                        "match": {
                            "starredBy": "wmao395"
                        }
                    },
                    "weight": 10
                },
                {
                    "filter": {
                        "match": {
                            "certificateStatus": "VERIFIED"
                        }
                    },
                    "weight": 16
                },
                {
                    "filter": {
                        "match": {
                            "certificateStatus": "DRAFT"
                        }
                    },
                    "weight": 5
                },
                {
                    "filter": {
                        "bool": {
                            "must_not": {
                                "exists": {
                                    "field": "certificateStatus"
                                }
                            }
                        }
                    },
                    "weight": 3
                },
                {
                    "filter": {
                        "match": {
                            "certificateStatus": "DEPRECATED"
                        }
                    },
                    "weight": 1
                },
                {
                    "filter": {
                        "bool": {
                            "must_not": [
                                {
                                    "terms": {
                                        "__typeName.keyword": [
                                            "Process",
                                            "DbtProcess"
                                        ]
                                    }
                                }
                            ]
                        }
                    },
                    "weight": 20
                },
                {
                    "filter": {
                        "terms": {
                            "__typeName.keyword": [
                                "Table",
                                "View",
                                "AtlasGlossaryTerm"
                            ]
                        }
                    },
                    "weight": 5
                },
                {
                    "filter": {
                        "term": {
                            "__typeName.keyword": "DataProduct"
                        }
                    },
                    "weight": 4
                },
                {
                    "filter": {
                        "terms": {
                            "__typeName.keyword": [
                                "Column",
                                "TableauDashboard",
                                "TableauWorkbook",
                                "TableauWorksheet",
                                "LookerDashboard",
                                "LookerExplore",
                                "PowerBIDashboard",
                                "PowerBIReport",
                                "MetabaseDashboard"
                            ]
                        }
                    },
                    "weight": 3
                },
                {
                    "filter": {
                        "terms": {
                            "__typeName.keyword": [
                                "MaterialisedView",
                                "LookerField"
                            ]
                        }
                    },
                    "weight": 2
                }
            ],
            "boost_mode": "sum",
            "score_mode": "sum"
        }
    },
    "aggs": {
        "group_by_typeName": {
            "terms": {
                "field": "__typeName.keyword",
                "size": 200
            },
            "aggs": {
                "group_by_assetUserDefinedType": {
                    "terms": {
                        "field": "assetUserDefinedType"
                    }
                }
            }
        }
    }
}